# Проектная работа: Определение наиболее выгодного региона нефтедобычи

## Описание проекта

Допустим, мы работаем в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину. 

Шаги для выбора локации обычно такие:

- В избранном регионе собирают характеристики для скважин: качество нефти и объём её запасов;
- Строят модель для предсказания объёма запасов в новых скважинах;
- Выбирают скважины с самыми высокими оценками значений;
- Определяют регион с максимальной суммарной прибылью отобранных скважин.

Нам предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. Необходимо построить модель для определения региона, где добыча принесёт наибольшую прибыль. 

## Планы по выполнению проекта:
1. Загрузить и подготовить данные. Пояснить порядок действий.

2. Обучить и проверить модель для каждого региона:
    1. Разбить данные на обучающую и валидационную выборки в соотношении 75:25.
    1. Обучить модель и сделать предсказания на валидационной выборке.
    1. Сохранить предсказания и правильные ответы на валидационной выборке.
    1. Напечатать на экране средний запас предсказанного сырья и RMSE модели.
    1. Проанализировать результаты.

3. Подготовить к расчёту прибыли:
    1. Все ключевые значения для расчётов сохранить в отдельных переменных.
    1. Рассчитать достаточный объём сырья для безубыточной разработки новой скважины. Сравнить полученный объём сырья со средним запасом в каждом регионе. 
    1. Написать выводы по этапу подготовки расчёта прибыли.

4. Написать функцию для расчёта прибыли по выбранным скважинам и предсказаниям модели:
    1. Выбрать скважины с максимальными значениями предсказаний. 
    1. Просуммировать целевое значение объёма сырья, соответствующее этим предсказаниям.
    1. Рассчитать прибыль для полученного объёма сырья.

5. Посчитать риски и прибыль для каждого региона:
    1. Применить технику Bootstrap с 1000 выборок, чтобы найти распределение прибыли.
    1. Найти среднюю прибыль, 95%-й доверительный интервал и риск убытков. Убыток — это отрицательная прибыль.
    1. Написать выводы: предложить регион для разработки скважин и обосновать выбор.

## Описание данных

Данные геологоразведки трёх регионов находятся в файлах: 
- `/datasets/geo_data_0.csv.`
- `/datasets/geo_data_1.csv.`
- `/datasets/geo_data_2.csv.`
- `id` — уникальный идентификатор скважины;
- `f0`, `f1`, `f2` — три признака точек (неважно, что они означают, но сами признаки значимы);
- `product` — объём запасов в скважине (тыс. баррелей).

## Условия задачи:
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

# Итог

## Обучение и проверка модели

##### После деления на обучающей и валидационной выборки с соотношением 75% и 25% обучили модель `LinearRegression` результаты получилось:

-------------------------------------------------------------------------------
**Регион № 1**
- RMSE модели линейн ой регрессии на валидационной выборке: `37.579`
- Средние предсказание модели: `92.593`
-------------------------------------------------------------------------------
**Регион № 2**
- RMSE модели линейной регрессии на валидационной выборке: `0.893`
- Средние предсказание модели: `68.729`
-------------------------------------------------------------------------------
**Регион № 3**
- RMSE модели линейной регрессии на валидационной выборке: `40.03`
- Средние предсказание модели: `94.965`
-------------------------------------------------------------------------------

## Подготовка к расчету прибыли

Однако у нас есть некоторые условия бизнеса (_*см. выше - условия задачи*_), поэтому рассчитали средний запас сырья каждого региона:
- Ср. запас сырья в 1 регионе: **92.5 млн.** баррелей
- Ср. запас сырья в 2 регионе: **68.825 млн.** баррелей
- Ср. запас сырья в 3 регионе: **95.0 млн.** баррелей

И с учетом выделенные деньги на постройку одной скважины - **50 млн. рублей** получилось, что объем каждой скважины (для безубыточный разработки) потребовалось **0.0004 тыс.** баррелей.

Затем мы сравнили полученный объем сырья со средним запасом в каждом регионе и сохранили и теперь находим возврат на инвестиции, т.к. нужно узнать, когда же инвестиционные вложения окупятся и эти ROI заполняем в текущий датасет. 

##### Формула ROI = (итоговая прибыль - инвестиции) / инвестици

Позже выяснили, в каком регионе больше всего попадаются отрицательные значения ROI.

-------------------------------------------------------------------------------
**Регион № 1**
- Кол-во точек с отрицательными значениями: `63417`
- Средние **ROI**: `-16.75%`
-------------------------------------------------------------------------------
**Регион № 2**
- Кол-во точек с отрицательными значениями: `83463`
- Средние **ROI**: `-38.0575%`
-------------------------------------------------------------------------------
**Регион № 3**
- Кол-во точек с отрицательными значениями: `61822`
- Средние **ROI**: `-14.5%`
-------------------------------------------------------------------------------

Здесь получается, что инвестировать второй регион не оказалось выгодным условием, т.к. большая часть является убыточной. Лучше всего оказалось третий регион

## Расчет прибыли и рисков

Выяснили суммарный объем сырья в тыс. баррелей: `2374126.1492`

И рассчитали прибыль для полученного объема сырья: `1058356.77` млн. рублей

Теперь сравним регионы по прибыли:

-------------------------------------------------------------------------------
**Регион № 1**
- Объем сырья: `29601.8357` тыс. баррелей
- Прибыль: `3320.83` млн. рублей
-------------------------------------------------------------------------------
**Регион № 2**
- Объем сырья: `27589.0815` тыс. баррелей
- Прибыль: `2415.09` млн. рублей
-------------------------------------------------------------------------------
**Регион № 3**
- Объем сырья: `28245.2221` тыс. баррелей
- Прибыль: `2710.35` млн. рублей
-------------------------------------------------------------------------------

Здесь видно, что первый регион оказался прибыльным по сравнению с остальными. Самый низкий показатель по прибыли оказался второй регион

## Посчитаем риски и прибыль для каждого региона с применением техники Bootstrap, чтобы находить распределение прибыли

После расчета выяснили:

-------------------------------------------------------------------------------
**Регион № 1**
- Вероятность 95% прибыль в этом регионе: `-102.09`  -  `947.98` млн. рублей
- Средняя выручка млн. рублей: `425.94`
- Вероятность убытки в этом регионе: `0.06`

![img.png](image/img.png)

-------------------------------------------------------------------------------
**Регион № 2**
- Вероятность 95% прибыль в этом регионе: `68.87`  -  `931.55` млн. рублей
- Средняя выручка млн. рублей: `515.22`
- Вероятность убытки в этом регионе: `0.01`

![img_1.png](image/img_1.png)
-------------------------------------------------------------------------------
**Регион № 3**
- Вероятность 95% прибыль в этом регионе: `-128.88`  -  `969.71` млн. рублей
- Средняя выручка млн. рублей: `435.01`
- Вероятность убытки в этом регионе: `0.064`

![img_2.png](image/img_2.png)
-------------------------------------------------------------------------------


На графике региона №2 можно невооруженными глазами можно заметить, 
что он занимает превосходство по минимальному уровню отклонения. 
А первый и второй регион приблизительное одинаковое значение по отклонению. 
Следовательно, лучше всего брать второй регион.

А по поводу график, в первом и втором графике можно увидеть сходство, 
но график прибыли у второго региона сдвинут направо, 
т.е. самым делая средним доходом в положительную сторону, 
а у третьго - более напоминает всего "нормальное распределение" 
и присутствует отрицательный квантиль.
