# Проектная работа: Построение модели определения стоимости автомобиля

## Описание проекта
Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 

Построить модель, которая умеет её определять. В нашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.

Критерии, которые важны заказчику:
- качество предсказания;
- время обучения модели;
- время предсказания модели.

## План по выполнению проекта

Чтобы усилить исследование, не ограничивайтесь градиентным бустингом. Попробуем более простые модели — иногда они работают лучше. Эти редкие случаи легко пропустить, если всегда применять только бустинг.

Поэкспериментируем и сравним характеристики моделей: время обучения, время предсказания, точность результата.

Основные шаги:

1. Загрузить данные, путь к файлу: `datasets/autos.csv`.
1. Изучить данные. Заполнить пропущенные значения и обработать аномалии в столбцах. Если среди признаков имеются неинформативные, удалить их.
1. Подготовить выборки для обучения моделей.
1. Обучить разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробовать разные гиперпараметры.
1. Проанализировать время обучения, время предсказания и качество моделей.
1. Опираясь на критерии заказчика, выбрать лучшую модель, проверить её качество на тестовой выборке.

Примечания:

1. Для оценки качества моделей применять метрику `RMSE`.
1. Значение метрики `RMSE` должно быть меньше `2500`.
1. Самостоятельно освоить библиотеку LightGBM и её средствами построить модели градиентного бустинга.
1. Время выполнения ячейки кода Jupyter Notebook можно получить специальной командой. Найти её.
1. Модель градиентного бустинга может долго обучаться, поэтому можно изменить у неё только два-три параметра.
1. Если перестанет работать Jupyter Notebook, можно удалить лишние переменные оператором del.

`del features_train`

## Описание данных

Данные находятся в файле `/datasets/autos.csv`.

**Признаки**: 
- `DateCrawled` — дата скачивания анкеты из базы
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л. с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была машина в ремонте или нет
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий автомобиля
- `PostalCode` — почтовый индекс владельца анкеты (пользователя)
- `LastSeen` — дата последней активности пользователя

**Целевой признак:** 
- `Price` — цена (евро)

# Подготовка к обучению - исследовательская работа и предобработка

Заметили огромные пропуски в некоторых признаках, что и было устранены их.

![img.png](image/img.png)

После предобработки данных мы отбросили и потеряли около **16%** данных. Это не критично.
Также заполнили пропуски заглушкой `unknown`. 

После устранения супер-выбросов:

![img_4.png](image/img_4.png)

# Обучение модели

Обучение модели делятся на несколько этапов:
1. Прямое кодирование - **One-Hot Encoding**
2. Порядковое кодиорование - **OrdinalEncoder**
3. Масштабирование признаков - **StandardScaler**
   1. Прямое кодирование - **One-Hot Encoding**
   2. Порядковое кодиорование - **OrdinalEncoder**

И были использованы список моделей:
1. LinearRegression
2. DecisionTreeRegressor
3. RandomForestRegressor
4. LightGBMRegressor
5. CatBoostRegressor

###### Итоговая таблица обученных моделей:

![img_1.png](image/img_1.png)


###### Итоговая таблица обученных моделей с рейтингом и RMSE не более 2500:

Попробуем устанавливать рейтинг. Критерии, которые важны заказчику: качество предсказания `RMSE`, время обучения модели `TIME TRAINING [s]` и время предсказания модели `TIME PREDICTION [s]`. Три параметры, значит будем рассматривать их вместе как 100%. Но качество предсказания будем устанавливать как 40%, а остальные по 30%.

![img_2.png](image/img_2.png)


###### Тройка лучших моделей

![img_3.png](image/img_3.png)

# Ввыод

Самой лучшей модели является `RandomForestRegressor_OE` - RMSE составляет **1606**, а скорость обучения составляет 6 секунда, время предсказания - 0,9 секунда. Вполне акдеватный результат, чтобы выбрать эту модель для реализации. Есть другая модель - `DecisionTreeRegressor_OE`, результаты неплохие, преимущества у нее - скорость обучения и предсказания. А третье мест о заслужила модель - `CatBoostRegressor_OE`, однако эта модель может похвастаться скоростью предсказания
